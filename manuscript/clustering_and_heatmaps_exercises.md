---
Title: Clustering and Heatmaps Exercise
---

A>## Exercises
A>
A>1. Create a random matrix with no correlation in the following way:
A>
A>    
    ```r
    set.seed(1)
    m = 10000
    n = 24
    x = matrix(rnorm(m*n),m,n)
    colnames(x)=1:n
    ```
A>
A>    Run hierarchical clustering on this data with the `hclust` function with default parameters to cluster the columns. Create a dendrogram. 
A>
A>    From the dendrogram which pairs of samples are the furthest away from each other?
A>    - A) 7 and 23
A>    - B) 19 and 14
A>    - C) 1 and 16
A>    - D) 17 and 18
A>
A>
A>
A>
A>
A>2. Set the seed at 1, `set.seed(1)` and replicate the creation of this matrix
A>    
    ```r
    m = 10000
    n = 24
    x = matrix(rnorm(m*n),m,n)
    ```
A>
A>    then perform hierarchical clustering as in the solution to exercise 1 and find the number of clusters if you use `cuttree` at height 143. Note that this number is a random variable.
A>
A>    Based on the Monte Carlo simulation, what is the standard error of this random variable?
A>
A>
A>
A>3. Run kmeans with 4 centers for the blood RNA data:
A>
A>
A>    
    ```r
    library(GSE5859Subset)
    data(GSE5859Subset)
    ```
A>
A>    Set the seed to 10, `set.seed(10)` right before running `kmeans` with 5 centers.
A>
A>    Explore the relationship of clusters and information in `sampleInfo`. Which of the following best described what you find:
A>    - A) `sampleInfo$group` is driving the clusters as the 0s and 1s are in completely different clusters/
A>    - B) The year is driving the clusters
A>    - C) Date is driving the clusters.
A>    - D) The clusters don't depend on any of the column of `sampleInfo`
A>
A>
A>
A>4. Load the data:
A>    
    ```r
    library(GSE5859Subset)
    data(GSE5859Subset)
    ```
A>
A>    Pick the 25 genes with the highest across sample variance. This function might help
A>
A>    
    ```r
    install.packages("matrixStats")
    library(matrixStats)
    ?rowMads ##we use mads due to a outlier sample
    ```
A>
A>    Use `heatmap.2` to make a heatmap showing the `sampleInfo$group` with color, the date as labels, the rows labelled with chromosome, and scaling the rows.
A>
A>    What do we learn from this heatmap?
A>    - A) The data appears as if it was generated by `rnorm`
A>    - B) Some genes in chr1 are very variable
A>    - C) A group of chrY genes are higher in group 0 and appear to drive the clustering. Within those clusters there appears to be clustering by month.
A>    - D) A group of chrY genes are higher in October compared to June and appear to drive the clustering. Within those clusters there appears to be clustering by `samplInfo$group`.
A>
A>
A>
A>
A>
A>5. Create a large data set of random data that is completely independent of `sampleInfo$group like this:
A>  
A>    
    ```r
    set.seed(17)
    m = nrow(geneExpression)
    n = ncol(geneExpression)
    x = matrix(rnorm(m*n),m,n)
    g = factor(sampleInfo$g )
    ```
A>
A>    Create two heatmaps with these data. Show the group g either with labels or colors. First, taking the 50 genes with smallest p-values obtained with `rowttests`. Then, taking the 50 genes with largest standard deviations.
A>
A>    Which of the following statements is true:
A>    - A)  There is no relationship between `g` and `x` but with 8,793 tests some will appear significant by chance. Selecting genes with    the t-test gives us a deceiving result.
A>    - B) These two techniques produced similar heatmaps
A>    - C) Selecting genes with the t-test is a better technique as it permits us to detect the two groups. It appears to find hidden     signals.
A>    - D) The genes with the largest standard deviation add variability to the plot and do not let us find the differences between the two groups.
A>
A>
